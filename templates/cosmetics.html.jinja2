{% from 'macros.html.jinja2' import list_selector %}
<div class="container" style="margin-top: 20px;">
    <div id="override_div"
         class="form-check form-switch item-switch center-flex"
         hidden>
        <label data-toggle="tooltip"
               title="Use Cosmetics set on UI instead of from the patch file.">
            <input class="form-check-input"
                   type="checkbox"
                   name="override_cosmetics"
                   id="override_cosmetics"
                   value="True"
                   display_name="Override Default Cosmetics"
                   checked/>
            Override Default Cosmetics
        </label>
    </div>
    <div class="row">
        <div class="col border panel">
            <div class="row">
                <h2 class="title">MISCELLANEOUS</h2>
                <div class="flex-container">
                    <div class="item-select">
                        <p class="select-title">D-Pad Display</p>
                        <select name="dpad_display"
                                id="dpad_display"
                                display_name="D-Pad Display"
                                class="form-select center-div"
                                aria-label="Randomization type"
                                data-toggle="tooltip"
                                title="Displays a D-pad overlay for Tag Anywhere and a Homing Ammo Toggle.">
                            <option selected value="off">
                                Off
                            </option>
                            <option value="on">
                                On
                            </option>
                            <option value="minimal">
                                Minimalistic
                            </option>
                        </select>
                    </div>
                    <div class="item-select">
                        <p class="select-title">Random Models</p>
                        <select name="random_models"
                                id="random_models"
                                display_name="Random Models"
                                class="form-select center-div"
                                aria-label="Random Models"
                                data-toggle="tooltip"
                                title="Changes various models in the game">
                            <option selected id="off" value="off" title="">
                                Off
                            </option>
                            <option id="random" value="random">
                                Random
                            </option>
                            <option id="extreme" value="extreme">
                                Extreme
                            </option>
                        </select>
                    </div>
                </div>
                <div class="flex-container">
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                               title="Randomizes miscellaneous cosmetic elements, including:&#10;- Peril Path Panic/Searchlight Seek Klaptraps&#10;- Skybox colors">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="misc_cosmetics"
                                   id="misc_cosmetics"
                                   display_name="Random Miscellaneous Cosmetics"
                                   value="True"/>
                            Random Miscellaneous Cosmetics
                        </label>
                    </div>
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                                title="Chunky will be replaced with his 'disco' variant that appears at the start of the DK Rap.">
                            <input class="form-check-input"
                                type="checkbox"
                                name="disco_chunky"
                                id="disco_chunky"
                                display_name="Disco Chunky"
                                value="True"/>
                            Disco Chunky
                        </label>
                    </div>
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                                title="Text bubbles will be darkened, with the font brightened.">
                            <input class="form-check-input"
                                type="checkbox"
                                name="dark_mode_textboxes"
                                id="dark_mode_textboxes"
                                display_name="Dark Mode Textboxes"
                                value="True"/>
                            Dark Mode Textboxes
                        </label>
                    </div>
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                                title="Various important segments in hints on the pause menu will be colored to assist with parsing.">
                            <input class="form-check-input"
                                type="checkbox"
                                name="pause_hint_coloring"
                                id="pause_hint_coloring"
                                display_name="Color Hints in Pause Menu"
                                value="True"
                                checked/>
                            Color Hints in Pause Menu
                        </label>
                    </div>
                    <div class="form-check form-switch item-switch holiday" hidden>
                        <label data-toggle="tooltip"
                               title="Happy Holidays from the DK64 Randomizer Dev Team. Limited time option.">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="holiday_setting_offseason"
                                   id="holiday_setting_offseason"
                                   display_name="Holiday Mode"
                                   value="False"/>
                            Holiday Mode
                        </label>
                    </div>
                    <div class="spacer holiday" hidden></div>
                    {# 
                    HANDLING HOLIDAY MODE:
                    Supported Holiday Mode (Is currently a holiday season)
                    - Remove "hidden" from holiday spacer
                    - Remove "hidden" from holiday item-switch
                    - Set input name/id to "holiday_setting"
                    - Set input value to "True"

                    Off-season:
                    - Add "hidden" from holiday spacer
                    - Add "hidden" from holiday item-switch
                    - Set input name/id to "holiday_setting_offseason"
                    - Set input value to "False"
                     #}
                </div>
            </div>
            <hr />
            <div class="row">
                <h2 class="title">ACCESSIBILITY</h2>
                <div class="flex-container">
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                               title="Remove water oscillation effects and the seasick ship rocking effect. For those who feel motion sick from these effects.">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="remove_water_oscillation"
                                   id="remove_water_oscillation"
                                   display_name="Remove Water Oscillation"
                                   value="True"/>
                            Remove Water Oscillation
                        </label>
                    </div>
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                               title="Adds kong faces to balloons, making them easier to distinguish in various lighting conditions.">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="head_balloons"
                                   id="head_balloons"
                                   display_name="Kong Head on Balloons"
                                   value="True"/>
                            Kong Head on Balloons
                        </label>
                    </div>
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                               title="Brightens the door-opening sequence in Troff 'n' Scoff to make the reward easier to see.">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="troff_brighten"
                                   id="troff_brighten"
                                   display_name="Brighten Boss Door Opening"
                                   value="True"/>
                            Brighten Boss Door Opening
                        </label>
                    </div>
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                               title="The crosshair used in various situations, like shooting your gun, will have a black outline.">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="crosshair_outline"
                                   id="crosshair_outline"
                                   display_name="Outlined Crosshair"
                                   value="True"/>
                            Outlined Crosshair
                        </label>
                    </div>
                </div>
                <div class="flex-container">
                    <div class="item-select">
                        <p class="select-title">
                            Colorblind Mode
                        </p>
                        <select name="colorblind_mode"
                                id="colorblind_mode"
                                display_name="Colorblind Mode"
                                class="form-select"
                                aria-label="Colorblind Mode">
                            <option selected value="off">
                                Off
                            </option>
                            <option value="prot">
                                Red-Green (Protan)
                            </option>
                            <option value="deut">
                                Red-Green (Deutan)
                            </option>
                            <option value="trit">
                                Blue-Yellow (Tritan)
                            </option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="col border panel">
            <h2 class="title">COLORS
                <label data-toggle="tooltip"
                        title="Randomizes all Kong and Transformation Colors.">
                    <input class="dice_checkbox"
                            type="checkbox"
                            name="random_colors"
                            id="random_colors"
                            value="True"/>
                    <label for="random_colors"></label>
                </label>
            </h2>
            {% set kong_zones = {"DK": ["Fur", "Tie"], "Diddy": ["Clothes"], "Lanky": ["Clothes", "Fur"], "Tiny": ["Clothes", "Hair"], "Chunky": ["Main", "Other"], "Rambi": ["Skin"], "Enguarde": ["Skin"]} %}
            <div class="flex-container">
                {% for kong in kong_zones %}
                    <div class="flex-container" style="flex-direction:column">
                        <div class="item-color-select">
                            <div class="color-selector">
                                <p class="select-title">{{ kong }}</p>
                                {% for zone in kong_zones[kong] %}
                                    <div id="{{ kong.lower() }}_{{ zone.lower() }}_custom">
                                        <div class="input-group mb-3 {{ kong.lower() }}{{ zone.lower() }}ColorPicker" style="display:flex">
                                            <select name="{{ kong.lower() }}_{{ zone.lower() }}_colors" id="{{ kong.lower() }}_{{ zone.lower() }}_colors" class="form-select" aria-label="{{ kong }} {{ zone }}">
                                                <option selected value="vanilla">{{ zone }}: Vanilla</option>
                                                <option value="randomized">{{ zone }}: Randomized</option>
                                                <option value="custom">{{ zone }}: Custom</option>
                                            </select>
                                            <div class="color-input-container">
                                                <input type="color"
                                                    name="{{ kong.lower() }}_{{ zone.lower() }}_custom_color"
                                                    id="{{ kong.lower() }}_{{ zone.lower() }}_custom_color"
                                                    default="#000000"
                                                    class="color-input">
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <hr />
            <div class="row">
                <h2 class="title">DEFAULT GAME SETTINGS</h2>
                <div class="flex-container">
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                               title="If enabled, the camera will look up when the player holds up on the stick, the opposite of how the vanilla game behaves.">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="camera_is_not_inverted"
                                   id="camera_is_not_inverted"
                                   display_name="Disable Y-Inverted First Person Camera"
                                   value="True"/>
                            Disable Y-Inverted First Person Camera
                        </label>
                    </div>
                    <div class="form-check form-switch item-switch">
                        <label data-toggle="tooltip"
                               title="Camera will always follow behind the player.">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="camera_is_follow"
                                   id="camera_is_follow"
                                   display_name="Follow Cam"
                                   value="True"/>
                            Follow Cam
                        </label>
                    </div>
                    <div class="flex-container" id="widescreen_row">
                        <div class="form-check form-switch item-switch">
                            <label data-toggle="tooltip"
                                title="IN DEVELOPMENT: 16:9 version of DK64, based off the standalone hack by gamemasterplc. EMULATOR ONLY: Consoles don't like this.">
                                <input class="form-check-input"
                                    type="checkbox"
                                    name="true_widescreen"
                                    id="true_widescreen"
                                    display_name="Widescreen (Emulator Only)"
                                    value="True"/>
                                Widescreen (Emulator Only)
                            </label>
                        </div>
                        <div class="spacer"></div>
                    </div>
                </div>
                {# <div class="flex-container">
                    <div class="item-select">
                        <p class="select-title">
                            Sound Type
                        </p>
                        <select name="sound_type"
                                id="sound_type"
                                class="form-select"
                                aria-label="Colorblind Mode">
                            <option selected value="stereo">
                                Stereo (Default)
                            </option>
                            <option value="surround">
                                Surround
                            </option>
                            <option value="mono">
                                Mono
                            </option>
                        </select>
                    </div>
                </div> #}
                <div class="flex-container">
                    <div class="item-group">
                        <p class="select-title">Music Volume (%)</p>
                        <input class="form-control"
                            min="0"
                            max="100"
                            name="music_volume"
                            id="music_volume"
                            display_name="Music Volume"
                            type="number"
                            data-toggle="tooltip"
                            title="Music Volume"
                            default="100"
                            placeholder="100"/>
                    </div>
                    <div class="item-group">
                        <p class="select-title">SFX Volume (%)</p>
                        <input class="form-control"
                            min="0"
                            max="100"
                            name="sfx_volume"
                            id="sfx_volume"
                            display_name="SFX Volume"
                            type="number"
                            data-toggle="tooltip"
                            title="SFX Volume"
                            default="100"
                            placeholder="100"/>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    KONG_ZONES = {
        "DK": ["Fur", "Tie"], 
        "Diddy": ["Clothes"], 
        "Lanky": ["Clothes", "Fur"], 
        "Tiny": ["Clothes", "Hair"], 
        "Chunky": ["Main", "Other"], 
        "Rambi": ["Skin"], 
        "Enguarde": ["Skin"]
    }
    
    $('.nav-tabs').click(function() {
        var settings = (document.cookie).split('saved_settings=')
        if (typeof settings[1] !== 'undefined') {
            var object = JSON.parse(settings[1])
            Object.keys(KONG_ZONES).forEach(kong => {
                KONG_ZONES[kong].forEach(zone => {
                    const attribute = `${kong.toLowerCase()}_${zone.toLowerCase()}_custom_color`;
                    const cls = `.${kong.toLowerCase()}${zone.toLowerCase()}ColorPicker`;
                    if (object.hasOwnProperty(attribute)) {
                        $(cls).attr('style', 'background-color:' + object[attribute] + ';')
                    }
                })
            })
        }
    })
    $(function() {
        var pattern = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'];
        var current = 0;

        var keyHandler = function (event) {
            // If the key isn't in the pattern, or isn't the current key in the pattern, reset
            if (pattern.indexOf(event.key) < 0 || event.key !== pattern[current]) {
                current = 0;
                return;
            }
            // Update how much of the pattern is complete
            current++;
            // If complete, remove hidden and reset
            if (pattern.length === current) {
                current = 0;
                $('.holiday').removeAttr('hidden');
            }
        };
        // Listen for keydown events
        document.addEventListener('keydown', keyHandler, false);
    })
</script>
